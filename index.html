<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Trang Chá»§ - Smart Agriculture</title>
  <link rel="icon" type="image/png" href="/placeholder.svg?height=32&width=32">
  <link rel="stylesheet" href="index.css">
  <link rel="icon" type="image/png" href="logo.png">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css">
</head>
<body>
  <!-- 1. Header (Pháº§n Ä‘áº§u trang) -->
  <header>
    <div class="logo">
      <img src="/JSPROJECT/logo.png" alt="Logo" class="logo-icon">
      SMART AGRICULTURE
    </div>
    <nav>
      <ul>
        <li><a href="#home">Trang chá»§</a></li>
        <li><a href="#features">TÃ­nh nÄƒng / Module</a></li>
        <li><a href="forum.html">Diá»…n Ä‘Ã n</a></li>
        <li><a href="payment.html">Sáº£n pháº©m</a></li>
        <li><a href="knowledgebase.html">Tin tá»©c / HÆ°á»›ng dáº«n</a></li>
        <li><a href="#contact">LiÃªn há»‡</a></li>
        <!-- TÃ¡ch nÃºt ÄÄƒng nháº­p / ÄÄƒng kÃ½ -->
        <li><a href="login.html" id="loginLink">ÄÄƒng nháº­p</a></li>
        <li><a href="register.html" id="registerLink">ÄÄƒng kÃ½</a></li>
        <li><a href="#" id="profileLink" style="display: none;">TÃ i khoáº£n</a></li> <!-- Sáº½ hiá»ƒn thá»‹ khi Ä‘Äƒng nháº­p -->
        <li><a href="#" id="logoutLink" style="display: none;">ÄÄƒng xuáº¥t</a></li>
      </ul>
    </nav>
  </header>

  <main>
    <!-- 2. Hero Section (Khu vá»±c áº¥n tÆ°á»£ng Ä‘áº§u trang) -->
    <section id="home" class="hero-section">
      <video autoplay muted loop playsinline class="hero-background">
        <source src="/JSPROJECT/hero-video.mp4" type="video/mp4">
        TrÃ¬nh duyá»‡t cá»§a báº¡n khÃ´ng há»— trá»£ video ná»n.
      </video>
      <div class="hero-overlay"></div>
      <div class="hero-content">
        <h1>Chuyá»ƒn Ä‘á»•i sá»‘ nÃ´ng nghiá»‡p â€“ Tá»‘i Æ°u hÃ³a canh tÃ¡c</h1>
        <div class="hero-cta">
          <a href="#features" class="button primary">Báº¯t Ä‘áº§u ngay</a>
        </div>
      </div>
    </section>
    <!-- 3. Danh SÃ¡ch TÃ­nh NÄƒng ChÃ­nh (Core Features) -->
    <section id="features" class="core-features-section">
      <h2>Danh SÃ¡ch TÃ­nh NÄƒng ChÃ­nh</h2>
      <div class="features-grid">
        <div class="feature-card">
          <div class="feature-icon">ğŸ“ˆ</div>
          <h3>Dá»± Ä‘oÃ¡n nÄƒng suáº¥t</h3>
          <p>Sá»­ dá»¥ng AI Ä‘á»ƒ dá»± bÃ¡o nÄƒng suáº¥t cÃ¢y trá»“ng, giÃºp báº¡n láº­p káº¿ hoáº¡ch hiá»‡u quáº£ hÆ¡n.</p>
          <a href="crop-prediction.html" class="button outline-primary">Xem chi tiáº¿t</a>
        </div>
        <div class="feature-card">
          <div class="feature-icon">ğŸŒ¦ï¸</div>
          <h3>Dá»± bÃ¡o thá»i tiáº¿t</h3>
          <p>Cung cáº¥p thÃ´ng tin thá»i tiáº¿t chÃ­nh xÃ¡c, cáº£nh bÃ¡o sá»›m cÃ¡c Ä‘iá»u kiá»‡n báº¥t lá»£i.</p>
          <a href="map.html" class="button outline-primary">Xem chi tiáº¿t</a>
        </div>
        <div class="feature-card">
          <div class="feature-icon">ğŸ§‘â€ğŸŒ¾</div>
          <h3>Quáº£n lÃ½ nÃ´ng tráº¡i</h3>
          <p>CÃ´ng cá»¥ toÃ n diá»‡n Ä‘á»ƒ quáº£n lÃ½ Ä‘áº¥t Ä‘ai, cÃ¢y trá»“ng, vÃ  tÃ i nguyÃªn nÃ´ng tráº¡i.</p>
          <a href="Farmmanagement.html" class="button outline-primary">Xem chi tiáº¿t</a>
        </div>
        <div class="feature-card">
          <div class="feature-icon">ğŸ’¬</div>
          <h3>Há»— trá»£ Chatbot</h3>
          <p>Trá»£ lÃ½ áº£o 24/7 giáº£i Ä‘Ã¡p tháº¯c máº¯c vÃ  cung cáº¥p lá»i khuyÃªn nÃ´ng nghiá»‡p.</p>
          <a href="ai.html" class="button outline-primary">Xem chi tiáº¿t</a>
        </div>
      </div>
    </section>

    <!-- 4. Sáº£n pháº©m Ná»•i báº­t (Featured Products Section) -->
    <section id="products" class="products-section">
      <h2>Sáº£n pháº©m Ná»•i báº­t</h2>
      <div class="product-grid">
        <!-- Products will be loaded here from Firestore -->
        <p id="loadingProducts" style="text-align: center; color: #666;">Äang táº£i sáº£n pháº©m...</p>
        <p id="noProducts" style="text-align: center; color: #666; display: none;">KhÃ´ng cÃ³ sáº£n pháº©m nÃ o Ä‘á»ƒ hiá»ƒn thá»‹.</p>
        <p id="productError" style="text-align: center; color: red; display: none;">Lá»—i khi táº£i sáº£n pháº©m. Vui lÃ²ng thá»­ láº¡i sau.</p>
      </div>
      <a href="payment.html" class="button primary large view-all-products">Xem táº¥t cáº£ sáº£n pháº©m</a>
    </section>
    <!-- 5. Tin tá»©c / HÆ°á»›ng dáº«n (Knowledge Section) -->
    <section id="knowledge" class="knowledge-section">
      <h2>Tin tá»©c / HÆ°á»›ng dáº«n</h2>
      <div class="articles-grid">
        <!-- Articles will be loaded here from Firestore -->
        <p id="loadingArticles" style="text-align: center; color: #666;">Äang táº£i bÃ i viáº¿t...</p>
        <p id="noArticles" style="text-align: center; color: #666; display: none;">KhÃ´ng cÃ³ bÃ i viáº¿t nÃ o Ä‘á»ƒ hiá»ƒn thá»‹.</p>
        <p id="articleError" style="text-align: center; color: red; display: none;">Lá»—i khi táº£i bÃ i viáº¿t. Vui lÃ²ng thá»­ láº¡i sau.</p>
      </div>
      <a href="knowledgebase.html" class="button primary large">Xem táº¥t cáº£ bÃ i viáº¿t</a> <!-- Updated href -->
    </section>

    <!-- 6. LiÃªn há»‡ / ÄÄƒng kÃ½ tÆ° váº¥n -->
    <section id="contact" class="contact-section">
      <h2>LiÃªn há»‡ / ÄÄƒng kÃ½ tÆ° váº¥n</h2>
      <div class="contact-grid">
        <div class="contact-form-container">
          <h3>ÄÄƒng kÃ½ nháº­n há»— trá»£</h3>
          <form class="contact-form" id="consultation-form">
            <label for="name">Há» vÃ  tÃªn</label>
            <input type="text" id="name" placeholder="Nguyá»…n VÄƒn A">

            <label for="email">Email</label>
            <input type="email" id="email" placeholder="email@example.com">

            <label for="phone">Sá»‘ Ä‘iá»‡n thoáº¡i</label>
            <input type="tel" id="phone" placeholder="0901234567">

            <label for="message">Ná»™i dung tin nháº¯n</label>
            <textarea id="message" placeholder="Báº¡n cáº§n tÆ° váº¥n vá» váº¥n Ä‘á» gÃ¬?" rows="5"></textarea>

            <button type="submit" class="button primary full-width">Gá»­i yÃªu cáº§u</button>
          </form>
        </div>

        <div class="contact-info-container">
          <h3>ThÃ´ng tin liÃªn há»‡</h3>
          <div class="contact-details">
            <p><span>ğŸ“§</span> vominhquan17102004@gmail.com</p>
            <p><span>ğŸ“</span> +84 76 265 7225</p>
            <p>Äá»‹a chá»‰: Táº§ng 81, TÃ²a nhÃ  LandMark,  Quáº­n 1, TP. Há»“ ChÃ­ Minh</p>
          </div>
          <div class="social-media">
            <h3>Máº¡ng xÃ£ há»™i</h3>
            <div class="social-icons">
              <a href="https://www.facebook.com/thien.777h" class="social-icon"><i class="bi bi-facebook"></i></a>
              <a href="https://www.instagram.com/sunyidd/" aria-label="Twitter"><i class="bi bi-instagram"></i></a>
            </div>
          </div>
        </div>
      </div>
    </section>
  </main>

  <!-- 7. Footer (ChÃ¢n trang) -->
  <footer>
    <div class="footer-content">
      <div class="footer-section about-project">
        <div class="logo">
          <img src="/JSPROJECT/logo.png" alt="Logo" class="logo-icon">
          SMART AGRICULTURE
        </div>
        <p>Giáº£i phÃ¡p nÃ´ng nghiá»‡p thÃ´ng minh hÃ ng Ä‘áº§u, giÃºp tá»‘i Æ°u hÃ³a canh tÃ¡c vÃ  nÃ¢ng cao nÄƒng suáº¥t cho nÃ´ng dÃ¢n Viá»‡t Nam.</p>
      </div>

      <div class="footer-section quick-links">
        <h3>LiÃªn káº¿t nhanh</h3>
        <ul>
          <li><a href="#home">Trang chá»§</a></li>
          <li><a href="#about">Giá»›i thiá»‡u</a></li>
          <li><a href="#features">TÃ­nh nÄƒng</a></li>
          <li><a href="#products">Sáº£n pháº©m</a></li>
          <li><a href="#knowledge">Tin tá»©c</a></li>
          <li><a href="#contact">LiÃªn há»‡</a></li>
        </ul>
      </div>

      <div class="footer-section policies">
        <h3>ChÃ­nh sÃ¡ch</h3>
        <ul>
          <li><a href="#">ChÃ­nh sÃ¡ch quyá»n riÃªng tÆ°</a></li>
          <li><a href="#">Äiá»u khoáº£n dá»‹ch vá»¥</a></li>
          <li><a href="#">ChÃ­nh sÃ¡ch hoÃ n tiá»n</a></li>
        </ul>
        <p class="copyright">Â© 2025 Smart Agriculture. All rights reserved.</p>
      </div>
    </div>
  </footer>

  <!-- Firebase Script -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
    import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";
    import {
      getFirestore, doc, getDoc,
      collection, query, getDocs, limit, orderBy, addDoc, serverTimestamp
    } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyA6WyGsOeOlct2BcOeQSZ6ogo2aGUa_MyQ",
      authDomain: "nongnghiepxanh-f6689.firebaseapp.com",
      projectId: "nongnghiepxanh-f6689",
      storageBucket: "nongnghiepxanh-f6689.firebasestorage.app",
      messagingSenderId: "846834085038",
      appId: "1:846834085038:web:cfac519e025896626d113f",
      measurementId: "G-619BFYRKGT"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore(app);

    onAuthStateChanged(auth, async (user) => {
      const logoutLink = document.getElementById('logoutLink');
      const profileLink = document.getElementById('profileLink');
      const loginLink = document.getElementById('loginLink');
      const registerLink = document.getElementById('registerLink');

      if (user) {
        // User is logged in
        loginLink.style.display = 'none';
        registerLink.style.display = 'none';
        profileLink.style.display = 'block'; // Show profile link

        try {
          const userDoc = await getDoc(doc(db, "users", user.uid));
          if (userDoc.exists()) {
            const role = userDoc.data().role;
            console.log("ROLE Cá»¦A USER:", role);

            if (role === "admin") {
              profileLink.href = "admin-dashboard.html";
              profileLink.textContent = "Admin Panel";
            } else {
              profileLink.href = "profile.html";
              profileLink.textContent = "TÃ i khoáº£n";
            }
          } else {
            console.log("KhÃ´ng tÃ¬m tháº¥y dá»¯ liá»‡u role cá»§a user.");
            profileLink.href = "profile.html";
            profileLink.textContent = "TÃ i khoáº£n";
          }
          logoutLink.style.display = 'block';
        } catch (error) {
          console.error("Lá»—i khi láº¥y role:", error);
        }
      } else {
        // User is logged out
        loginLink.style.display = 'block';
        registerLink.style.display = 'block';
        profileLink.style.display = 'none'; // Hide profile link
        logoutLink.style.display = 'none';
      }
    });

    document.getElementById('logoutLink').addEventListener('click', (event) => {
      event.preventDefault();
      signOut(auth).then(() => {
        location.reload();
      }).catch((error) => {
        console.error('ÄÄƒng xuáº¥t tháº¥t báº¡i:', error.message);
      });
    });
    // --- Fetch Featured Products from Firestore ---
    async function fetchFeaturedProducts() {
  const productGrid = document.querySelector('.product-grid');
  const loadingMessage = document.getElementById('loadingProducts');
  const noProductsMessage = document.getElementById('noProducts');
  const errorMessage = document.getElementById('productError');

  // Reset tráº¡ng thÃ¡i UI
  productGrid.innerHTML = '';
  loadingMessage.style.display = 'block';
  noProductsMessage.style.display = 'none';
  errorMessage.style.display = 'none';

  try {
    const productsCol = collection(db, 'products');
    const q = query(productsCol, limit(4)); // Giá»›i háº¡n 4 sáº£n pháº©m ná»•i báº­t
    const productSnapshot = await getDocs(q);

    if (productSnapshot.empty) {
      loadingMessage.style.display = 'none';
      noProductsMessage.style.display = 'block';
      return;
    }

    productSnapshot.forEach(doc => {
      const product = doc.data();

      const productCard = `
        <div class="product-card">
          <img src="${product.imageUrl || '/placeholder.svg?height=200&width=200'}" alt="${product.name || 'Sáº£n pháº©m'}" class="product-image">
          <h3 class="product-name">${product.name || 'ChÆ°a Ä‘áº·t tÃªn'}</h3>
          <p class="product-description">${product.description || ''}</p>
          <p class="product-price">${(product.price || 0).toLocaleString('vi-VN')} VNÄ</p>
          <button class="button primary add-to-cart" data-id="${doc.id}">ThÃªm vÃ o giá» hÃ ng</button>
        </div>
      `;

      productGrid.insertAdjacentHTML('beforeend', productCard);
    });

    loadingMessage.style.display = 'none';

  } catch (error) {
    console.error("Lá»—i khi táº£i sáº£n pháº©m tá»« Firestore:", error);
    loadingMessage.style.display = 'none';
    errorMessage.style.display = 'block';
  }
}
    // Call the function to fetch products when the page loads
    document.addEventListener('DOMContentLoaded', fetchFeaturedProducts);
    // --- Fetch Knowledge Articles from Firestore ---
    async function fetchKnowledgeArticles() {
      const articlesGrid = document.querySelector('.articles-grid');
      const loadingMessage = document.getElementById('loadingArticles');
      const noArticlesMessage = document.getElementById('noArticles');
      const errorMessage = document.getElementById('articleError');

      loadingMessage.style.display = 'block';
      noArticlesMessage.style.display = 'none';
      errorMessage.style.display = 'none';
      articlesGrid.innerHTML = ''; // Clear existing content

      try {
        const articlesCol = collection(db, 'articles'); // Assuming a collection named 'articles'
        const q = query(articlesCol, orderBy('date', 'desc'), limit(3)); // Get 3 latest articles
        const articleSnapshot = await getDocs(q);

        if (articleSnapshot.empty) {
          noArticlesMessage.style.display = 'block';
          loadingMessage.style.display = 'none';
          return;
        }

        articleSnapshot.forEach(doc => {
          const article = doc.data();
          const articleCard = `
            <div class="article-card">
              <h3>${article.title || 'KhÃ´ng cÃ³ tiÃªu Ä‘á»'}</h3>
              <p>${article.excerpt || ''}</p>
            </div>
          `;
          articlesGrid.insertAdjacentHTML('beforeend', articleCard);
        });

        loadingMessage.style.display = 'none';

      } catch (error) {
        console.error("Lá»—i khi táº£i bÃ i viáº¿t tá»« Firestore:", error);
        errorMessage.style.display = 'block';
        loadingMessage.style.display = 'none';
      }
    }

    // Call functions to fetch data when the page loads
    document.addEventListener('DOMContentLoaded', () => {
      fetchKnowledgeArticles();
    });
    // Handle form submission
    document.getElementById('consultation-form').addEventListener('submit', async (e) => {
    e.preventDefault();
    
    const form = e.target;
    const name = form.name.value;
    const email = form.email.value;
    const phone = form.phone.value;
    const message = form.message.value;

    // Kiá»ƒm tra dá»¯ liá»‡u Ä‘áº§u vÃ o
    if (!name || !email || !phone) {
      alert('Vui lÃ²ng Ä‘iá»n Ä‘áº§y Ä‘á»§ thÃ´ng tin báº¯t buá»™c (Há» tÃªn, Email, SÄT)');
      return;
    }

    try {
      // ThÃªm dá»¯ liá»‡u vÃ o Firestore
      await addDoc(collection(db, 'consultations'), {
        name,
        email,
        phone,
        message,
        timestamp: serverTimestamp(), // ThÃªm timestamp tá»± Ä‘á»™ng
        status: 'pending' // Tráº¡ng thÃ¡i máº·c Ä‘á»‹nh
      });
      
      alert('YÃªu cáº§u tÆ° váº¥n Ä‘Ã£ Ä‘Æ°á»£c gá»­i thÃ nh cÃ´ng! ChÃºng tÃ´i sáº½ liÃªn há»‡ láº¡i vá»›i báº¡n sá»›m nháº¥t.');
      form.reset(); // Reset form sau khi gá»­i thÃ nh cÃ´ng
    } catch (error) {
      console.error('Lá»—i khi gá»­i yÃªu cáº§u:', error);
      alert('ÄÃ£ cÃ³ lá»—i xáº£y ra khi gá»­i yÃªu cáº§u. Vui lÃ²ng thá»­ láº¡i sau.');
    }
  });

  </script>
</body>
</html>
